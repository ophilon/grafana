<!DOCTYPE html>
<h1 id="set-up-git-sync">Set up Git Sync</h1>


<div class="admonition admonition-caution"><blockquote><p class="title text-uppercase">Caution</p><p>Git Sync is an <a href="/docs/release-life-cycle/">experimental feature</a> introduced in Grafana v12 for open source and Enterprise editions. Engineering and on-call support is not available. Documentation is either limited or not provided outside of code comments. No SLA is provided. Enable the <code>provisioning</code> and <code>kubernetesDashboards</code> feature toggles in Grafana to use this feature. This feature is not publicly available in Grafana Cloud yet. Only the cloud-hosted version of GitHub (GitHub.com) is supported at this time. GitHub Enterprise is not yet compatible.</p>
<p>Sign up for Grafana Cloud Git Sync early access using <a href="https://forms.gle/WKkR3EVMcbqsNnkD9" target="_blank" rel="noopener noreferrer">this form</a>.</p></blockquote></div>

<p>Git Sync lets you manage Grafana dashboards as code by storing dashboards JSON files and folders in a remote GitHub repository.
Alternatively, you can configure a local file system instead of using GitHub.
Refer to 
    <a href="/docs/grafana/latest/observability-as-code/provision-resources/file-path-setup/">Set up file provisioning</a> for information.</p>
<p>This page explains how to use Git Sync with a GitHub repository.</p>
<p>To set up Git Sync, you need to:</p>
<ol>
<li>Enable feature toggles in Grafana (first time set up).</li>
<li>Configure a connection to your GitHub repository.</li>
<li>Choose what content to sync with Grafana.</li>
<li>Optional: Extend Git Sync by enabling pull request notifications and image previews of dashboard changes.</li>
</ol>
<table>
  <thead>
      <tr>
          <th>Capability</th>
          <th>Benefit</th>
          <th>Requires</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Adds a table summarizing changes to your pull request</td>
          <td>Provides a convenient way to save changes back to GitHub.</td>
          <td>Webhooks configured</td>
      </tr>
      <tr>
          <td>Add a dashboard preview image to a PR</td>
          <td>View a snapshot of dashboard changes to a pull request without opening Grafana.</td>
          <td>Image renderer plugin and webhooks configured</td>
      </tr>
  </tbody>
</table>
<h2 id="performance-impacts-of-enabling-git-sync">Performance impacts of enabling Git Sync</h2>
<p>Git Sync is an experimental feature and is under continuous development.</p>
<p>We recommend evaluating the performance impact, if any, in a non-production environment.</p>
<p>When Git Sync is enabled, the database load might increase, especially for instances with a lot of folders and nested folders.
Reporting any issues you encounter can help us improve Git Sync.</p>
<h2 id="before-you-begin">Before you begin</h2>
<p>To set up Git Sync, you need:</p>
<ul>
<li>Administration rights in your Grafana organization.</li>
<li>Enable the required feature toggles in your Grafana instance. Refer to <a href="#enable-required-feature-toggles">Enable required feature toggles</a> for instructions.</li>
<li>A GitHub repository to store your dashboards in.
<ul>
<li>If you want to use a local file path, refer to 
    <a href="/docs/grafana/latest/observability-as-code/provision-resources/file-path-setup/">the local file path guide</a>.</li>
</ul>
</li>
<li>A GitHub access token. The Grafana UI will also explain this to you as you set it up.</li>
<li>Optional: A public Grafana instance.</li>
<li>Optional: Image Renderer plugin to save image previews with your PRs.</li>
</ul>
<h2 id="enable-required-feature-toggles">Enable required feature toggles</h2>
<p>To activate Git Sync in Grafana, you need to enable the <code>provisioning</code> and <code>kubernetesDashboards</code> feature toggles.
For additional information about feature toggles, refer to 
    <a href="/docs/grafana/latest/setup-grafana/configure-grafana/feature-toggles/">Configure feature toggles</a>.</p>
<p>To enable the required feature toggles, add them to your Grafana configuration file:</p>
<ol>
<li>
<p>Open your Grafana configuration file, either <code>grafana.ini</code> or <code>custom.ini</code>. For file location based on operating system, refer to 
    <a href="/docs/grafana/latest/setup-grafana/configure-grafana/feature-toggles/#experimental-feature-toggles">Configuration file location</a>.</p>
</li>
<li>
<p>Locate or add a <code>[feature_toggles]</code> section. Add these values:</p>
<pre>[feature_toggles]
provisioning = true
kubernetesDashboards = true ; use k8s from browser</pre>
</li>
<li>
<p>Save the changes to the file and restart Grafana.</p>
</li>
</ol>
<h2 id="create-a-github-access-token">Create a GitHub access token</h2>
<p>Whenever you connect to a GitHub repository, you need to create a GitHub access token with specific repository permissions.
This token needs to be added to your Git Sync configuration to enable read and write permissions between Grafana and GitHub repository.</p>
<ol>
<li>
<p>Create a new token using <a href="https://github.com/settings/personal-access-tokens/new" target="_blank" rel="noopener noreferrer">Create new fine-grained personal access token</a>. Refer to <a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens" target="_blank" rel="noopener noreferrer">Managing your personal access tokens</a> for instructions.</p>
</li>
<li>
<p>Under <strong>Permissions</strong>, expand <strong>Repository permissions</strong>.</p>
</li>
<li>
<p>Set these permissions for Git Sync:</p>
<ul>
<li><strong>Contents</strong>: Read and write permission</li>
<li><strong>Metadata</strong>: Read-only permission</li>
<li><strong>Pull requests</strong>: Read and write permission</li>
<li><strong>Webhooks</strong>: Read and write permission</li>
</ul>
</li>
<li>
<p>Select any additional options and then press <strong>Generate token</strong>.</p>
</li>
<li>
<p>Verify the options and select <strong>Generate token</strong>.</p>
</li>
<li>
<p>Copy the access token. Leave the browser window available with the token until you&rsquo;ve completed configuration.</p>
</li>
</ol>
<p>GitHub Apps are not currently supported.</p>
<h2 id="set-up-the-connection-to-github">Set up the connection to GitHub</h2>
<p>Use <strong>Provisioning</strong> to guide you through setting up Git Sync to use a GitHub repository.</p>
<ol>
<li>Log in to your Grafana server with an account that has the Grafana Admin flag set.</li>
<li>Select <strong>Administration</strong> in the left-side menu and then <strong>Provisioning</strong>.</li>
<li>Select <strong>Configure Git Sync</strong>.</li>
</ol>
<h3 id="connect-to-external-storage">Connect to external storage</h3>
<p>To connect your GitHub repository, follow these steps:</p>
<ol>
<li>Paste your GitHub personal access token into <strong>Enter your access token</strong>. Refer to <a href="#create-a-github-access-token">Create a GitHub access token</a> for instructions.</li>
<li>Paste the <strong>Repository URL</strong> for your GitHub repository into the text box.</li>
<li>Enter a branch to use. The default value is <code>main</code>.</li>
<li>Add a <strong>Path</strong> to a subdirectory where your dashboards are stored. The default value is <code>grafana/</code>. If your dashboards are stored in the root of your repository, then remove the directory name.</li>
<li>Select <strong>Choose what to synchronize</strong> to have the connection to your repository verified and continue setup.</li>
</ol>
<h3 id="choose-what-to-synchronize">Choose what to synchronize</h3>
<p>You can choose to either use one repository for an entire organization or to a new Grafana folder (up to 10 connections).
If you choose to sync all resources with external storage, then all of your dashboards are synced to that one repository.
You won&rsquo;t have the option of setting up additional repositories to connect to.</p>
<p>You can choose to synchronize all resources with GitHub or you can sync resources to a new Grafana folder.
The options you have depend on the status of your GitHub repository.
For example, if you are syncing with a new or empty repository, you won&rsquo;t have an option to migrate dashboards.</p>
<ol>
<li>Select how resources should be handled in Grafana.</li>
</ol>
<ul>
<li>Choose <strong>Sync all resources with external storage</strong> if you want to sync and manage your entire Grafana instance through external storage. You can only have one provisioned connection with this selection.</li>
<li>Choose <strong>Sync external storage to new Grafana folder</strong> to sync external resources into a new folder without affecting the rest of your instance. You can repeat this process for up to 10 connections. - Enter a <strong>Display name</strong> for the repository connection. Resources stored in this connection appear under the chosen display name in the Grafana UI.</li>
</ul>
<!--  - Select **Migrate instance to repository** to migrate the Grafana instance to the repository. This option is not available during the first time you set up remote provisioning. -->
<ol>
<li>Select <strong>Synchronize</strong> to continue.</li>
</ol>
<!-- This is only relevant if we include the "Migrate instance to repository" option above. -->
<!-- ### Synchronize with external storage

The first time you connect Grafana with a GitHub repository, you need to synchronize with external storage.
Future updates will be automatically saved to the repository and provisioned back to the instance.



<div class="admonition admonition-note"><blockquote><p class="title text-uppercase">Note</p><p>During the synchronization process, your dashboards will be temporarily unavailable.
No data or configuration will be lost.
However, no one will be able to create, edit, or delete resources during this process.
In the last step, the resources will disappear and will reappear and be managed through external storage.</p></blockquote></div>


1. Select **History** to include commits for each historical value in the synchronized data.
1. Select **Begin synchronization** to continue. -->
<h3 id="choose-additional-settings">Choose additional settings</h3>
<p>Finally, you can set up how often your configured storage is polled for updates.</p>
<ol>
<li>For <strong>Update instance interval (seconds)</strong>, enter how often you want the instance to pull updates from GitHub. The default value is 60 seconds.</li>
<li>Optional: Select <strong>Read only</strong> to ensure resources can&rsquo;t be modified in Grafana.</li>
</ol>
<!-- No workflow option listed in the UI. 1. For **Workflows**, select the GitHub workflows that you want to allow to run in the repository. Both **Branch** and **Write** are selected by default. -->
<ol>
<li>Optional: If you have the Grafana Image Renderer plugin configured, you can <strong>Enable dashboards previews in pull requests</strong>. If image rendering is not available, then you can&rsquo;t select this option. For more information, refer to <a href="/grafana/plugins/grafana-image-renderer/">Grafana Image Renderer</a>.</li>
<li>Select <strong>Finish</strong> to proceed.</li>
</ol>
<h2 id="verify-your-dashboards-in-grafana">Verify your dashboards in Grafana</h2>
<p>To verify that your dashboards are available at the location that you specified, click <strong>Dashboards</strong>. The name of the dashboard is listed in the <strong>Name</strong> column.</p>
<p>Now that your dashboards have been synced from a repository, you can customize the name, change the branch, and create a pull request (PR) for it.
Refer to 
    <a href="/docs/grafana/latest/observability-as-code/provision-resources/use-git-sync/">Use Git Sync</a> for more information.</p>
<h2 id="configure-webhooks-and-image-rendering">Configure webhooks and image rendering</h2>
<p>You can extend Git Sync by getting instant updates and pull requests using webhooks and add dashboard previews in pull requests.</p>
<h3 id="set-up-webhooks-for-realtime-notification-and-pull-request-integration">Set up webhooks for realtime notification and pull request integration</h3>
<p>When connecting to a GitHub repository, Git Sync use webhooks to enable real-time updates from GitHub public repositories or enable the pull request integration.
Without webhooks, the polling interval is set in the final configuration screen (default is 60 seconds).
Your Grafana instance must be exposed to the public internet.
You can do this via port forwarding and DNS, a tool such as <code>ngrok</code>, or any other method you prefer.</p>
<p>The permissions set in your GitHub access token provide the authorization for this communication.</p>
<p>If you use local storage, then Git Sync only provides periodic pulling.</p>
<!-- Grafana Cloud support not available yet


<div class="admonition admonition-note"><blockquote><p class="title text-uppercase">Note</p><p>Webhooks are automatically available for Grafana Cloud users.</p></blockquote></div>

-->
<p>Set up webhooks with whichever service or tooling you prefer.
For example, you can use Cloudflare Tunnels with a Cloudflare-managed domain, port-forwarding and DNS options, or a tool such as <code>ngrok</code>.</p>
<p>After you have the public URL, you can add it to your Grafana configuration file:</p>
<pre>[server]
root_url = https://PUBLIC_DOMAIN.HERE</pre>
<p>You can check the configured webhooks in the <strong>View</strong> link for your GitHub repository from <strong>Administration</strong> &gt; <strong>Provisioning</strong>.</p>
<h4 id="necessary-paths">Necessary paths</h4>
<p>If your security setup does not permit publicly exposing the Grafana instance, you can either choose to allowlist the GitHub IP addresses, or expose only the necessary paths.</p>
<p>The necessary paths required to be exposed are (RegExp):</p>
<ul>
<li><code>/apis/provisioning\.grafana\.app/v0(alpha1)?/namespaces/[^/]+/repositories/[^/]+/(webhook|render/.*)$</code></li>
</ul>
<!-- TODO: Path for the blob storage for image rendering? @ryantxu would know this best. -->
<h3 id="set-up-image-rendering-for-dashboard-previews">Set up image rendering for dashboard previews</h3>
<p>By setting up image rendering, you can add visual previews of dashboard updates directly in pull requests.
Image rendering also requires webhooks.</p>
<p>You can enable this capability by installing the Grafana Image Renderer plugin in your Grafana instance.
For more information and installation instructions, refer to <a href="/grafana/plugins/grafana-image-renderer/">Grafana Image Renderer</a>.</p>
<h2 id="modify-configurations-after-set-up-is-complete">Modify configurations after set up is complete</h2>
<p>To update your repository configuration after you&rsquo;ve completed set up:</p>
<ol>
<li>Log in to your Grafana server with an account that has the Grafana Admin flag set.</li>
<li>Select <strong>Administration</strong> in the left-side menu and then <strong>Provisioning</strong>.</li>
<li>Select <strong>Settings</strong> for the repository you wish to modify.</li>
<li>Use the <strong>Configure repository</strong> screen to update any of the settings.</li>
<li>Select <strong>Save</strong> to preserve the updates.</li>
</ol>
