<!DOCTYPE html>
<h1 id="set-up-grafana-for-high-availability">Set up Grafana for high availability</h1>


<div class="admonition admonition-note"><blockquote><p class="title text-uppercase">Note</p><p>To prevent duplicate alerts in Grafana high availability, additional steps are required.</p>
<p>Please refer to <a href="#alerting-high-availability">Alerting high availability</a> for more information.</p></blockquote></div>

<p>Grafana uses an embedded sqlite3 database to store users, dashboards, and other persistent data by default. For high availability, you must use a shared database to store this data. This shared database can be either MySQL or Postgres.</p>
<div class="text-center">
  <img src="/static/img/docs/tutorials/grafana-high-availability.png"  max-width= "800px" class="center" />
</div>
<h2 id="architecture">Architecture</h2>
<p>Your Grafana high availability environment will consist of two or more Grafana servers (cluster nodes) served by a load balancing reverse proxy. The cluster uses an active-active architecture with the load balancer allocating traffic between nodes and re-allocating traffic to surviving nodes should there be failures. You need to configure your load balancer with a listener that responds to a shared cluster hostname. The shared name is the hostname your users use to access Grafana.</p>
<p>For ease of use, we recommend you configure your load balancer to provide SSL termination. The shared Grafana database tracks session information, so your load balancer won&rsquo;t need to provide session affinity services. See your load balancer&rsquo;s documentation for details on its configuration and operations.</p>
<h2 id="before-you-begin">Before you begin</h2>
<p>Before you complete the following tasks, configure a MySQL or Postgres database to be highly available. Configuring the MySQL or Postgres database for high availability is out of the scope of this guide, but you can find instructions online for each database.</p>
<h2 id="configure-multiple-grafana-servers-to-use-the-same-database">Configure multiple Grafana servers to use the same database</h2>
<p>Once you have a Postgres or MySQL database available, you can configure your multiple Grafana instances to use a shared backend database. Grafana has default and custom configuration files, and you can update the database settings by updating your custom configuration file as described in the <a href="../configure-grafana/#database">[database]</a>. Once configured to use a shared database, your multiple Grafana instances will persist all long-term data in that database.</p>
<h2 id="grafana-enterprise-only-license-your-grafana-servers">Grafana Enterprise only: License your Grafana servers</h2>
<p>If you&rsquo;re using Grafana Enterprise:</p>
<ol>
<li>Get a license token in the name of your cluster&rsquo;s shared hostname.</li>
<li>Edit the 
    <a href="/docs/grafana/latest/setup-grafana/configure-grafana/#root_url"><code>root_url</code></a> setting in each node&rsquo;s <code>grafana.ini</code> configuration file to reflect the cluster&rsquo;s shared hostname.</li>
<li>Install the license key as normal. For more information on installing your license key, refer to 
    <a href="/docs/grafana/latest/administration/enterprise-licensing/#step-2-add-your-license-to-a-grafana-instance">Add your license to a Grafana instance</a>.</li>
</ol>
<h2 id="alerting-high-availability">Alerting high availability</h2>
<p>Grafana Alerting provides a high availability mode. It preserves the semantics of legacy dashboard alerting by executing all alerts on every server and by sending notifications only once per alert. Load distribution between servers is not supported at this time.</p>
<p>For further information and instructions on setting up alerting high availability, refer to <a href="../../alerting/set-up/configure-high-availability/">Enable alerting high availability</a>.</p>
<p><strong>Legacy dashboard alerts</strong></p>
<p>Legacy Grafana Alerting supports a limited form of high availability. In this model, alert notifications are deduplicated when running multiple servers. This means all alerts are executed on every server, but alert notifications are only sent once per alert. Grafana does not support load distribution between servers.</p>
<h2 id="grafana-live">Grafana Live</h2>
<p>Grafana Live works with limitations in highly available setup. For details, refer to the <a href="../set-up-grafana-live/#configure-grafana-live-ha-setup">Configure Grafana Live HA setup</a>.</p>
<h2 id="user-sessions">User sessions</h2>
<p>Grafana uses auth token strategy with database by default. This means that a load balancer can send a user to any Grafana server without having to log in on each server.</p>
