<!DOCTYPE html>
<h1 id="configure-enhanced-ldap-integration">Configure enhanced LDAP integration</h1>
<p>The enhanced LDAP integration adds additional functionality on top of the <a href="../ldap/">LDAP integration</a> available in the open source edition of Grafana.</p>


<div class="admonition admonition-note"><blockquote><p class="title text-uppercase">Note</p><p>Available in <a href="../../../../introduction/grafana-enterprise/">Grafana Enterprise</a> and <a href="/docs/grafana-cloud/">Grafana Cloud</a>.
If you are a Grafana Cloud customer, please <a href="/profile/org#support">open a support ticket in the Cloud Portal</a> to request this feature.</p></blockquote></div>

<blockquote>
<p>To control user access with role-based permissions, refer to <a href="../../../../administration/roles-and-permissions/access-control/">role-based access control</a>.</p></blockquote>
<h2 id="ldap-group-synchronization-for-teams">LDAP group synchronization for teams</h2>
<p>With enhanced LDAP integration, you can set up synchronization between LDAP groups and teams. This enables LDAP users that are members
of certain LDAP groups to automatically be added or removed as members to certain teams in Grafana.</p>
<p><img
  class="lazyload d-inline-block"
  data-src="/static/img/docs/enterprise/team_members_ldap.png"
  alt="LDAP group synchronization" width="979"
     height="382"/></p>
<p>Grafana keeps track of all synchronized users in teams, and you can see which users have been synchronized from LDAP in the team members list, see <code>LDAP</code> label in screenshot.
This mechanism allows Grafana to remove an existing synchronized user from a team when its LDAP group membership changes. This mechanism also allows you to manually add
a user as member of a team, and it will not be removed when the user signs in. This gives you flexibility to combine LDAP group memberships and Grafana team memberships.</p>
<p>
    <a href="/docs/grafana/latest/setup-grafana/configure-security/configure-team-sync/">Learn more about team sync.</a></p>
<div class="clearfix"></div>
<h2 id="active-ldap-synchronization">Active LDAP synchronization</h2>
<p>In the open source version of Grafana, user data from LDAP is synchronized only during the login process when authenticating using LDAP.</p>
<p>With active LDAP synchronization, you can configure Grafana to actively sync users with LDAP servers in the background. Only users that have logged into Grafana at least once are synchronized.</p>
<p>Users with updated role and team membership will need to refresh the page to get access to the new features.</p>
<p>Removed users are automatically logged out and their account disabled. These accounts are displayed in the <strong>Server Admin &gt; Users</strong> page with a <code>disabled</code> label. Disabled users keep their custom permissions on dashboards, folders, and data sources, so if you add them back in your LDAP database, they have access to the application with the same custom permissions as before.</p>
<pre>[auth.ldap]
...

# You can use the Cron syntax or several predefined schedulers -
# @yearly (or @annually) | Run once a year, midnight, Jan. 1st        | 0 0 1 1 *
# @monthly               | Run once a month, midnight, first of month | 0 0 1 * *
# @weekly                | Run once a week, midnight between Sat/Sun  | 0 0 * * 0
# @daily (or @midnight)  | Run once a day, midnight                   | 0 0 * * *
# @hourly                | Run once an hour, beginning of hour        | 0 * * * *
sync_cron = &#34;0 1 * * *&#34; # This is default value (At 1 am every day)
# This cron expression format uses 5 space-separated fields, for example
# sync_cron = &#34;*/10 * * * *&#34;
# This will run the LDAP Synchronization every 10th minute, which is also the minimal interval between the Grafana sync times i.e. you cannot set it for every 9th minute

# You can also disable active LDAP synchronization
active_sync_enabled = true # enabled by default</pre>
<p>Single bind configuration (as in the <a href="../ldap/#single-bind-example">Single bind example</a>) is not supported with active LDAP synchronization because Grafana needs user information to perform LDAP searches.</p>
<p>For the synchronization to work, the <code>servers.search_filter</code> and <code>servers.attributes.username</code> in the <code>ldap.toml</code> configuration file must match. By default, the <code>servers.attributes.username</code> is <code>cn</code>, so if you use another attribute as the search filter, you must also update the username attribute.</p>
<p>For example:</p>
<pre>[[servers]]
search_filter = &#34;(sAMAccountName=%s)&#34;

[servers.attributes]
username  = &#34;sAMAccountName&#34;</pre>
<p>If the attributes aren&rsquo;t the same, the users&rsquo; sessions will be terminated after each synchronization. That&rsquo;s because the search will be done using the username&rsquo;s value, and that value doesn&rsquo;t exist for the attribute used in the search filter.</p>
