<!DOCTYPE html>
<h1 id="organization-api">Organization API</h1>
<p>The Organization HTTP API is divided in two resources, <code>/api/org</code> (current organization)
and <code>/api/orgs</code> (admin organizations). One big difference between these are that
the admin of all organizations API only works with basic authentication, see <a href="#admin-organizations-api">Admin Organizations API</a> for more information.</p>
<blockquote>
<p>If you are running Grafana Enterprise, for some endpoints you&rsquo;ll need to have specific permissions. Refer to <a href="/docs/grafana/latest/administration/roles-and-permissions/access-control/custom-role-actions-scopes/">Role-based access control permissions</a> for more information.</p></blockquote>
<h2 id="current-organization-api">Current Organization API</h2>
<h3 id="get-current-organization">Get current Organization</h3>
<p><code>GET /api/org/</code></p>
<p><strong>Required permissions</strong></p>
<p>See note in the <a href="#organization-api">introduction</a> for an explanation.</p>
<table>
  <thead>
      <tr>
          <th>Action</th>
          <th>Scope</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>orgs:read</td>
          <td>N/A</td>
      </tr>
  </tbody>
</table>
<p><strong>Example Request</strong>:</p>
<pre>GET /api/org/ HTTP/1.1
Accept: application/json
Content-Type: application/json
Authorization: Bearer eyJrIjoiT0tTcG1pUlY2RnVKZTFVaDFsNFZXdE9ZWmNrMkZYbk</pre>
<p><strong>Example Response</strong>:</p>
<pre>HTTP/1.1 200
Content-Type: application/json

{
  &#34;id&#34;:1,
  &#34;name&#34;:&#34;Main Org.&#34;
}</pre>
<h3 id="get-all-users-within-the-current-organization">Get all users within the current organization</h3>
<p><code>GET /api/org/users</code></p>
<p>Returns all org users within the current organization.
Accessible to users with org admin role.</p>
<p><strong>Required permissions</strong></p>
<p>See note in the <a href="#organization-api">introduction</a> for an explanation.</p>
<table>
  <thead>
      <tr>
          <th>Action</th>
          <th>Scope</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>org.users:read</td>
          <td>users:*</td>
      </tr>
  </tbody>
</table>
<p><strong>Example Request</strong>:</p>
<pre>GET /api/org/users HTTP/1.1
Accept: application/json
Content-Type: application/json
Authorization: Bearer eyJrIjoiT0tTcG1pUlY2RnVKZTFVaDFsNFZXdE9ZWmNrMkZYbk</pre>
<p><strong>Example Response</strong>:</p>
<pre>HTTP/1.1 200
Content-Type: application/json

[
  {
    &#34;orgId&#34;: 1,
    &#34;userId&#34;: 1,
    &#34;email&#34;: &#34;admin@localhost&#34;,
    &#34;avatarUrl&#34;: &#34;/avatar/46d229b033af06a191ff2267bca9ae56&#34;,
    &#34;login&#34;: &#34;admin&#34;,
    &#34;role&#34;: &#34;Admin&#34;,
    &#34;lastSeenAt&#34;: &#34;2019-08-09T11:02:49+02:00&#34;,
    &#34;lastSeenAtAge&#34;: &#34;&lt; 1m&#34;
  }
]</pre>
<h3 id="get-all-users-within-the-current-organization-lookup">Get all users within the current organization (lookup)</h3>
<p><code>GET /api/org/users/lookup</code></p>
<p>Returns all org users within the current organization, but with less detailed information.
Accessible to users with org admin role, admin in any folder or admin of any team.
Mainly used by Grafana UI for providing list of users when adding team members and
when editing folder/dashboard permissions.</p>
<p><strong>Required permissions</strong></p>
<p>See note in the <a href="#organization-api">introduction</a> for an explanation.</p>
<table>
  <thead>
      <tr>
          <th>Action</th>
          <th>Scope</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>org.users:read</td>
          <td>users:*</td>
      </tr>
  </tbody>
</table>
<p><strong>Example Request</strong>:</p>
<pre>GET /api/org/users/lookup HTTP/1.1
Accept: application/json
Content-Type: application/json
Authorization: Bearer eyJrIjoiT0tTcG1pUlY2RnVKZTFVaDFsNFZXdE9ZWmNrMkZYbk</pre>
<p><strong>Example Response</strong>:</p>
<pre>HTTP/1.1 200
Content-Type: application/json

[
  {
    &#34;userId&#34;: 1,
    &#34;login&#34;: &#34;admin&#34;,
    &#34;avatarUrl&#34;: &#34;/avatar/46d229b033af06a191ff2267bca9ae56&#34;
  }
]</pre>
<h3 id="updates-the-given-user">Updates the given user</h3>
<p><code>PATCH /api/org/users/:userId</code></p>
<p><strong>Required permissions</strong></p>
<p>See note in the <a href="#organization-api">introduction</a> for an explanation.</p>
<table>
  <thead>
      <tr>
          <th>Action</th>
          <th>Scope</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>org.users:write</td>
          <td>users:*</td>
      </tr>
  </tbody>
</table>
<p><strong>Example Request</strong>:</p>
<pre>PATCH /api/org/users/1 HTTP/1.1
Accept: application/json
Content-Type: application/json
Authorization: Bearer eyJrIjoiT0tTcG1pUlY2RnVKZTFVaDFsNFZXdE9ZWmNrMkZYbk

{
  &#34;role&#34;: &#34;Viewer&#34;,
}</pre>
<p><strong>Example Response</strong>:</p>
<pre>HTTP/1.1 200
Content-Type: application/json

{&#34;message&#34;:&#34;Organization user updated&#34;}</pre>
<h3 id="delete-user-in-current-organization">Delete user in current organization</h3>
<p><code>DELETE /api/org/users/:userId</code></p>
<p><strong>Required permissions</strong></p>
<p>See note in the <a href="#organization-api">introduction</a> for an explanation.</p>
<table>
  <thead>
      <tr>
          <th>Action</th>
          <th>Scope</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>org.users:remove</td>
          <td>users:*</td>
      </tr>
  </tbody>
</table>
<p><strong>Example Request</strong>:</p>
<pre>DELETE /api/org/users/1 HTTP/1.1
Accept: application/json
Content-Type: application/json
Authorization: Bearer eyJrIjoiT0tTcG1pUlY2RnVKZTFVaDFsNFZXdE9ZWmNrMkZYbk</pre>
<p><strong>Example Response</strong>:</p>
<pre>HTTP/1.1 200
Content-Type: application/json

{&#34;message&#34;:&#34;User removed from organization&#34;}</pre>
<h3 id="update-current-organization">Update current Organization</h3>
<p><code>PUT /api/org</code></p>
<p><strong>Required permissions</strong></p>
<p>See note in the <a href="#organization-api">introduction</a> for an explanation.</p>
<table>
  <thead>
      <tr>
          <th>Action</th>
          <th>Scope</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>orgs:write</td>
          <td>N/A</td>
      </tr>
  </tbody>
</table>
<p><strong>Example Request</strong>:</p>
<pre>PUT /api/org HTTP/1.1
Accept: application/json
Content-Type: application/json
Authorization: Bearer eyJrIjoiT0tTcG1pUlY2RnVKZTFVaDFsNFZXdE9ZWmNrMkZYbk

{
  &#34;name&#34;:&#34;Main Org.&#34;
}</pre>
<p><strong>Example Response</strong>:</p>
<pre>HTTP/1.1 200
Content-Type: application/json

{&#34;message&#34;:&#34;Organization updated&#34;}</pre>
<h3 id="add-a-new-user-to-the-current-organization">Add a new user to the current organization</h3>
<p><code>POST /api/org/users</code></p>
<p>Adds a global user to the current organization.</p>
<p><strong>Required permissions</strong></p>
<p>See note in the <a href="#organization-api">introduction</a> for an explanation.</p>
<table>
  <thead>
      <tr>
          <th>Action</th>
          <th>Scope</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>org.users:add</td>
          <td>users:*</td>
      </tr>
  </tbody>
</table>
<p><strong>Example Request</strong>:</p>
<pre>POST /api/org/users HTTP/1.1
Accept: application/json
Content-Type: application/json
Authorization: Bearer eyJrIjoiT0tTcG1pUlY2RnVKZTFVaDFsNFZXdE9ZWmNrMkZYbk

{
  &#34;role&#34;: &#34;Admin&#34;,
  &#34;loginOrEmail&#34;: &#34;admin&#34;
}</pre>
<p><strong>Example Response</strong>:</p>
<pre>HTTP/1.1 200
Content-Type: application/json

{&#34;message&#34;:&#34;User added to organization&#34;,&#34;userId&#34;:1}</pre>
<h2 id="admin-organizations-api">Admin Organizations API</h2>


<div class="admonition admonition-caution"><blockquote><p class="title text-uppercase">Caution</p><p>You can&rsquo;t authenticate to the Admin Organizations HTTP API with service account tokens.
Service accounts are limited to an organization and an organization role.
They can&rsquo;t be granted 
    <a href="/docs/grafana/latest/administration/roles-and-permissions/#grafana-server-administrators">Grafana server administrator permissions</a>.</p>
<p>To use these API endpoints you have to use Basic authentication and the Grafana user must have the Grafana server administrator permission.</p>
<p>The <code>admin</code> user that Grafana is provisioned with by default has permissions to use these API endpoints.</p></blockquote></div>

<h3 id="get-organization-by-id">Get Organization by Id</h3>
<p><code>GET /api/orgs/:orgId</code></p>
<p>Only works with Basic Authentication (username and password), see <a href="#admin-organizations-api">introduction</a>.</p>
<p><strong>Required permissions</strong></p>
<p>See note in the <a href="#organization-api">introduction</a> for an explanation.</p>
<table>
  <thead>
      <tr>
          <th>Action</th>
          <th>Scope</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>orgs:read</td>
          <td>N/A</td>
      </tr>
  </tbody>
</table>
<p><strong>Example Request</strong>:</p>
<pre>GET /api/orgs/1 HTTP/1.1
Accept: application/json
Content-Type: application/json</pre>
<p><strong>Example Response</strong>:</p>
<pre>HTTP/1.1 200
Content-Type: application/json

{
  &#34;id&#34;:1,
  &#34;name&#34;:&#34;Main Org.&#34;,
  &#34;address&#34;:{
    &#34;address1&#34;:&#34;&#34;,
    &#34;address2&#34;:&#34;&#34;,
    &#34;city&#34;:&#34;&#34;,
    &#34;zipCode&#34;:&#34;&#34;,
    &#34;state&#34;:&#34;&#34;,
    &#34;country&#34;:&#34;&#34;
  }
}</pre>
<h3 id="get-organization-by-name">Get Organization by Name</h3>
<p><code>GET /api/orgs/name/:orgName</code></p>
<p>Only works with Basic Authentication (username and password), see <a href="#admin-organizations-api">introduction</a>.</p>
<p><strong>Required permissions</strong></p>
<p>See note in the <a href="#organization-api">introduction</a> for an explanation.</p>
<table>
  <thead>
      <tr>
          <th>Action</th>
          <th>Scope</th>
          <th>Note</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>orgs:read</td>
          <td>N/A</td>
          <td>Needs to be assigned globally.</td>
      </tr>
  </tbody>
</table>
<p><strong>Example Request</strong>:</p>
<pre>GET /api/orgs/name/Main%20Org%2E HTTP/1.1
Accept: application/json
Content-Type: application/json</pre>
<p><strong>Example Response</strong>:</p>
<pre>HTTP/1.1 200
Content-Type: application/json

{
  &#34;id&#34;:1,
  &#34;name&#34;:&#34;Main Org.&#34;,
  &#34;address&#34;:{
    &#34;address1&#34;:&#34;&#34;,
    &#34;address2&#34;:&#34;&#34;,
    &#34;city&#34;:&#34;&#34;,
    &#34;zipCode&#34;:&#34;&#34;,
    &#34;state&#34;:&#34;&#34;,
    &#34;country&#34;:&#34;&#34;
  }
}</pre>
<h3 id="create-organization">Create Organization</h3>
<p><code>POST /api/orgs</code></p>
<p>Only works with Basic Authentication (username and password), see <a href="#admin-organizations-api">introduction</a>.</p>
<p><strong>Required permissions</strong></p>
<p>See note in the <a href="#organization-api">introduction</a> for an explanation.</p>
<table>
  <thead>
      <tr>
          <th>Action</th>
          <th>Scope</th>
          <th>Note</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>orgs:create</td>
          <td>N/A</td>
          <td>Needs to be assigned globally.</td>
      </tr>
  </tbody>
</table>
<p><strong>Example Request</strong>:</p>
<pre>POST /api/orgs HTTP/1.1
Accept: application/json
Content-Type: application/json

{
  &#34;name&#34;:&#34;New Org.&#34;
}</pre>
<p>Note: The api will work in the following two ways</p>
<ol>
<li>Need to set GF_USERS_ALLOW_ORG_CREATE=true</li>
<li>Set the config value users.allow_org_create to true in ini file</li>
</ol>
<p><strong>Example Response</strong>:</p>
<pre>HTTP/1.1 200
Content-Type: application/json

{
  &#34;orgId&#34;:&#34;1&#34;,
  &#34;message&#34;:&#34;Organization created&#34;
}</pre>
<h3 id="search-all-organizations">Search all Organizations</h3>
<p><code>GET /api/orgs?perpage=10&amp;page=1</code></p>
<p>Only works with Basic Authentication (username and password), see <a href="#admin-organizations-api">introduction</a>.</p>
<p><strong>Required permissions</strong></p>
<p>See note in the <a href="#organization-api">introduction</a> for an explanation.</p>
<table>
  <thead>
      <tr>
          <th>Action</th>
          <th>Scope</th>
          <th>Note</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>orgs:read</td>
          <td>N/A</td>
          <td>Needs to be assigned globally.</td>
      </tr>
  </tbody>
</table>
<p><strong>Example Request</strong>:</p>
<pre>GET /api/orgs HTTP/1.1
Accept: application/json
Content-Type: application/json</pre>
<p>Note: The api will only work when you pass the admin name and password
to the request HTTP URL, like http://admin:admin@localhost:3000/api/orgs</p>
<p>Default value for the <code>perpage</code> parameter is <code>1000</code> and for the <code>page</code> parameter is <code>0</code>.</p>
<p><strong>Example Response</strong>:</p>
<pre>HTTP/1.1 200
Content-Type: application/json

[
  {
    &#34;id&#34;:1,
    &#34;name&#34;:&#34;Main Org.&#34;
  }
]</pre>
<h3 id="update-organization">Update Organization</h3>
<p><code>PUT /api/orgs/:orgId</code></p>
<p>Update Organization, fields <em>Address 1</em>, <em>Address 2</em>, <em>City</em> are not implemented yet.
Only works with Basic Authentication (username and password), see <a href="#admin-organizations-api">introduction</a>.</p>
<p><strong>Required permissions</strong></p>
<p>See note in the <a href="#organization-api">introduction</a> for an explanation.</p>
<table>
  <thead>
      <tr>
          <th>Action</th>
          <th>Scope</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>orgs:write</td>
          <td>N/A</td>
      </tr>
  </tbody>
</table>
<p><strong>Example Request</strong>:</p>
<pre>PUT /api/orgs/1 HTTP/1.1
Accept: application/json
Content-Type: application/json

{
  &#34;name&#34;:&#34;Main Org 2.&#34;
}</pre>
<p><strong>Example Response</strong>:</p>
<pre>HTTP/1.1 200
Content-Type: application/json

{&#34;message&#34;:&#34;Organization updated&#34;}</pre>
<h3 id="delete-organization">Delete Organization</h3>
<p><code>DELETE /api/orgs/:orgId</code></p>
<p>Only works with Basic Authentication (username and password), see <a href="#admin-organizations-api">introduction</a>.</p>
<p><strong>Required permissions</strong></p>
<p>See note in the <a href="#organization-api">introduction</a> for an explanation.</p>
<table>
  <thead>
      <tr>
          <th>Action</th>
          <th>Scope</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>orgs:delete</td>
          <td>N/A</td>
      </tr>
  </tbody>
</table>
<p><strong>Example Request</strong>:</p>
<pre>DELETE /api/orgs/1 HTTP/1.1
Accept: application/json</pre>
<p><strong>Example Response</strong>:</p>
<pre>HTTP/1.1 200
Content-Type: application/json

{&#34;message&#34;:&#34;Organization deleted&#34;}</pre>
<h3 id="get-users-in-organization">Get Users in Organization</h3>
<p><code>GET /api/orgs/:orgId/users</code></p>
<p>Only works with Basic Authentication (username and password), see <a href="#admin-organizations-api">introduction</a>.</p>
<p><strong>Required permissions</strong></p>
<p>See note in the <a href="#organization-api">introduction</a> for an explanation.</p>
<table>
  <thead>
      <tr>
          <th>Action</th>
          <th>Scope</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>org.users:read</td>
          <td>users:*</td>
      </tr>
  </tbody>
</table>
<p><strong>Example Request</strong>:</p>
<pre>GET /api/orgs/1/users HTTP/1.1
Accept: application/json
Content-Type: application/json</pre>
<p>Note: The api will only work when you pass the admin name and password
to the request HTTP URL, like http://admin:admin@localhost:3000/api/orgs/1/users</p>
<p><strong>Example Response</strong>:</p>
<pre>HTTP/1.1 200
Content-Type: application/json
[
  {
    &#34;orgId&#34;:1,
    &#34;userId&#34;:1,
    &#34;email&#34;:&#34;admin@mygraf.com&#34;,
    &#34;login&#34;:&#34;admin&#34;,
    &#34;role&#34;:&#34;Admin&#34;
  }
]</pre>
<h3 id="add-user-in-organization">Add User in Organization</h3>
<p><code>POST /api/orgs/:orgId/users</code></p>
<p>Only works with Basic Authentication (username and password), see <a href="#admin-organizations-api">introduction</a>.</p>
<p><strong>Required permissions</strong></p>
<p>See note in the <a href="#organization-api">introduction</a> for an explanation.</p>
<table>
  <thead>
      <tr>
          <th>Action</th>
          <th>Scope</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>org.users:add</td>
          <td>users:*</td>
      </tr>
  </tbody>
</table>
<p><strong>Example Request</strong>:</p>
<pre>POST /api/orgs/1/users HTTP/1.1
Accept: application/json
Content-Type: application/json

{
  &#34;loginOrEmail&#34;:&#34;user&#34;,
  &#34;role&#34;:&#34;Viewer&#34;
}</pre>
<p><strong>Example Response</strong>:</p>
<pre>HTTP/1.1 200
Content-Type: application/json

{&#34;message&#34;:&#34;User added to organization&#34;, &#34;userId&#34;: 1}</pre>
<h3 id="update-users-in-organization">Update Users in Organization</h3>
<p><code>PATCH /api/orgs/:orgId/users/:userId</code></p>
<p>Only works with Basic Authentication (username and password), see <a href="#admin-organizations-api">introduction</a>.</p>
<p><strong>Required permissions</strong></p>
<p>See note in the <a href="#organization-api">introduction</a> for an explanation.</p>
<table>
  <thead>
      <tr>
          <th>Action</th>
          <th>Scope</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>org.users:write</td>
          <td>users:*</td>
      </tr>
  </tbody>
</table>
<p><strong>Example Request</strong>:</p>
<pre>PATCH /api/orgs/1/users/2 HTTP/1.1
Accept: application/json
Content-Type: application/json

{
  &#34;role&#34;:&#34;Admin&#34;
}</pre>
<p><strong>Example Response</strong>:</p>
<pre>HTTP/1.1 200
Content-Type: application/json

{&#34;message&#34;:&#34;Organization user updated&#34;}</pre>
<h3 id="delete-user-in-organization">Delete User in Organization</h3>
<p><code>DELETE /api/orgs/:orgId/users/:userId</code></p>
<p>Only works with Basic Authentication (username and password), see <a href="#admin-organizations-api">introduction</a>.</p>
<p><strong>Required permissions</strong></p>
<p>See note in the <a href="#organization-api">introduction</a> for an explanation.</p>
<table>
  <thead>
      <tr>
          <th>Action</th>
          <th>Scope</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>org.users:remove</td>
          <td>users:*</td>
      </tr>
  </tbody>
</table>
<p><strong>Example Request</strong>:</p>
<pre>DELETE /api/orgs/1/users/2 HTTP/1.1
Accept: application/json
Content-Type: application/json</pre>
<p><strong>Example Response</strong>:</p>
<pre>HTTP/1.1 200
Content-Type: application/json

{&#34;message&#34;:&#34;User removed from organization&#34;}</pre>
