<!DOCTYPE html>
<h1 id="configure-the-graphite-data-source">Configure the Graphite data source</h1>
<p>This document provides instructions for configuring the Graphite data source and explains available configuration options. For general information on managing data sources, refer to 
    <a href="/docs/grafana/latest/administration/data-source-management/">Data source management</a>.</p>
<h2 id="before-you-begin">Before you begin</h2>
<ul>
<li>
<p>You must have the <code>Organization administrator</code> role to configure the Graphite data source.
Organization administrators can also <a href="#provision-the-data-source">configure the data source via YAML</a> with the Grafana provisioning system.</p>
</li>
<li>
<p>Grafana comes with a built-in Graphite data source plugin, eliminating the need to install a plugin.</p>
</li>
<li>
<p>Familiarize yourself with your Graphite security configuration and gather any necessary security certificates and client keys.</p>
</li>
</ul>
<h2 id="add-the-graphite-data-source">Add the Graphite data source</h2>
<p>To configure basic settings for the data source, complete the following steps:</p>
<ol>
<li>Click <strong>Connections</strong> in the left-side menu.</li>
<li>Click <strong>Add new connection</strong></li>
<li>Type <code>Graphite</code> in the search bar.</li>
<li>Select the <strong>Graphite data source</strong>.</li>
<li>Click <strong>Add new data source</strong> in the upper right.</li>
</ol>
<p>Grafana takes you to the <strong>Settings</strong> tab, where you will set up your Graphite configuration.</p>
<h2 id="configuration-options-in-the-ui">Configuration options in the UI</h2>
<p>Following is a list of configuration options for Graphite.</p>
<table>
  <thead>
      <tr>
          <th>Setting</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Name</strong></td>
          <td>The display name for the data source. This is how you&rsquo;ll reference it in panels and queries. <br>Examples: <code>graphite-1</code>, <code>graphite-metrics</code>.</td>
      </tr>
      <tr>
          <td><strong>Default</strong></td>
          <td>When enabled, sets this data source as the default for dashboard panels. It will be automatically selected when creating new panels.</td>
      </tr>
  </tbody>
</table>
<p><strong>HTTP:</strong></p>
<table>
  <thead>
      <tr>
          <th>Setting</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>URL</strong></td>
          <td>Sets the HTTP protocol, IP, and port of your <code>graphite-web</code> or <code>graphite-api</code> installation. <br>Since the access method is set to <em>Server</em>, the URL must be accessible from the Grafana backend.</td>
      </tr>
      <tr>
          <td><strong>Allowed cookies</strong></td>
          <td>By default, Grafana removes forwarded cookies. Specify cookie names here to allow them to be forwarded to the data source.</td>
      </tr>
      <tr>
          <td><strong>Timeout</strong></td>
          <td>Sets the HTTP request timeout in seconds.</td>
      </tr>
  </tbody>
</table>
<p><strong>Auth:</strong></p>
<table>
  <thead>
      <tr>
          <th><strong>Setting</strong></th>
          <th><strong>Description</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Basic Auth</strong></td>
          <td>Toggle on to enable basic authentication to the data source.</td>
      </tr>
      <tr>
          <td>  <strong>User</strong></td>
          <td>Sets the username used for basic authentication.</td>
      </tr>
      <tr>
          <td>  <strong>Password</strong></td>
          <td>Enter the password used for basic authentication.</td>
      </tr>
      <tr>
          <td><strong>With Credentials</strong></td>
          <td>Toggle on to include cookies and authentication headers in cross-origin requests.</td>
      </tr>
      <tr>
          <td><strong>TLS Client Auth</strong></td>
          <td>Toggle on to enable TLS client authentication (both server and client are verified).</td>
      </tr>
      <tr>
          <td>  <strong>ServerName</strong></td>
          <td>The server name used to verify the hostname on the certificate returned by the server.</td>
      </tr>
      <tr>
          <td>  <strong>Client Cert</strong></td>
          <td>Client certificate generated by a Certificate Authority (CA) or self-signed.</td>
      </tr>
      <tr>
          <td>  <strong>Client Key</strong></td>
          <td>Private key used to encrypt communication between the client and server. Also generated by a CA or self-signed.</td>
      </tr>
      <tr>
          <td><strong>With CA Cert</strong></td>
          <td>Toggle on to authenticate with a CA certificate.</td>
      </tr>
      <tr>
          <td>  <strong>CA Cert</strong></td>
          <td>CA certificate used to validate the server certificate.</td>
      </tr>
      <tr>
          <td><strong>Skip TLS Verify</strong></td>
          <td>Toggle on to bypass TLS certificate validation. Not recommended unless necessary or for testing purposes.</td>
      </tr>
      <tr>
          <td><strong>Forward OAuth Identity</strong></td>
          <td>Toggle on to forward the user&rsquo;s upstream OAuth identity to the data source. Grafana includes the access token in the request.</td>
      </tr>
  </tbody>
</table>
<p><strong>Custom HTTP Headers:</strong></p>
<p>Pass along additional information and metadata about the request or response.</p>
<table>
  <thead>
      <tr>
          <th><strong>Setting</strong></th>
          <th><strong>Description</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Header</strong></td>
          <td>Add a custom header. This allows custom headers to be passed based on the needs of your Graphite instance.</td>
      </tr>
      <tr>
          <td><strong>Value</strong></td>
          <td>The value of the header.</td>
      </tr>
  </tbody>
</table>
<p><strong>Graphite details:</strong></p>
<table>
  <thead>
      <tr>
          <th><strong>Setting</strong></th>
          <th><strong>Description</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Version</strong></td>
          <td>Select your Graphite version from the drop-down. This controls which functions are available in the Graphite query editor. Use <code>1.1.x</code> for Grafana Cloud Graphite.</td>
      </tr>
      <tr>
          <td><strong>Graphite backend type</strong></td>
          <td>Select the Graphite backend type. Choosing <code>Metrictank</code> enables additional features like query processing metadata. (<code>Metrictank</code> is a multi-tenant time series engine compatible with Graphite.) Use <code>Default</code> for Grafana Cloud Graphite.</td>
      </tr>
      <tr>
          <td><strong>Rollup indicator</strong></td>
          <td>Toggle on to display an info icon in panel headers when data aggregation (rollup) occurs. Only available when <code>Metrictank</code> is selected.</td>
      </tr>
  </tbody>
</table>
<p><strong>Label mappings:</strong></p>
<p>Label mappings are the rules you define to tell Grafana how to pull pieces of the Graphite metric path into Loki labels when switching data sources. They are currently only supported between Graphite and Loki queries.</p>
<p>When you change your data source from Graphite to Loki, your queries are automatically mapped based on the rules you define. To create a mapping, specify the full path of the metric and replace the nodes you want to map with label names, using parentheses. The corresponding label values are extracted from your Graphite query during the data source switch.</p>
<p>Grafana automatically maps all Graphite tags to labels, even if you haven’t defined explicit mappings. When using matching patterns with <code>{}</code>(e.g., <code>metric.{a,b}.value</code>), Grafana converts them to Loki’s regular expression matching syntax. If your queries include functions, Graphite extracts the relevant metrics and tags, then matches them against your mappings.</p>
<table>
  <thead>
      <tr>
          <th><strong>Graphite Query</strong></th>
          <th><strong>Mapped to Loki Query</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>alias(servers.west.001.cpu,1,2)</code></td>
          <td><code>{cluster=&quot;west&quot;, server=&quot;001&quot;}</code></td>
      </tr>
      <tr>
          <td><code>alias(servers.*.{001,002}.*,1,2)</code></td>
          <td><code>{server=~&quot;(001,002)&quot;}</code></td>
      </tr>
      <tr>
          <td><code>interpolate(seriesByTag('foo=bar', 'server=002'), inf)</code></td>
          <td><code>{foo=&quot;bar&quot;, server=&quot;002&quot;}</code></td>
      </tr>
  </tbody>
</table>
<table>
  <thead>
      <tr>
          <th><strong>Setting</strong></th>
          <th><strong>Description</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Private data source connect</strong></td>
          <td><em>Only for Grafana Cloud users.</em> Establishes a private, secured connection between a Grafana Cloud stack and data sources within a private network. Use the drop-down to locate the PDC URL. For setup instructions, refer to <a href="docs/grafana-cloud/connect-externally-hosted/private-data-source-connect/">Private data source connect (PDC)</a> and <a href="/docs/grafana-cloud/connect-externally-hosted/private-data-source-connect/configure-pdc/#configure-grafana-private-data-source-connect-pdc">Configure PDC</a>. Click <strong>Manage private data source connect</strong> to open your PDC connection page and view your configuration details.</td>
      </tr>
  </tbody>
</table>
<p>|</p>
<p>After configuring your Graphite data source options, click <strong>Save &amp; test</strong> at the bottom to test the connection. You should see a confirmation dialog box that says:</p>
<p><strong>Data source is working</strong></p>
<h2 id="provision-the-data-source">Provision the data source</h2>
<p>You can define and configure the data source in YAML files as part of the Grafana provisioning system.
For more information about provisioning, and for lists of common configuration options and JSON data options, refer to 
    <a href="/docs/grafana/latest/administration/provisioning/#data-sources">Provisioning data sources</a>.</p>
<p>Example Graphite YAML provisioning file:</p>
<pre>apiVersion: 1

datasources:
  - name: Graphite
    type: graphite
    access: proxy
    url: http://localhost:8080
    jsonData:
      graphiteVersion: &#39;1.1&#39;</pre>
